configure_file (BotCore.py.in BotCore.py @ONLY)

set (INIT_PY ${CMAKE_CURRENT_BINARY_DIR}/__init__.py)

file (WRITE  ${INIT_PY} "\"\"\"CMAKE AUTOGENERATED FILE - DO NOT EDIT BY HAND!!\"\"\"\n")
file (APPEND ${INIT_PY} "from BotCore import *\n")
file (APPEND ${INIT_PY} "\n")

if (NOT EXISTS ${PYTHON_OUTPUT_PATH}/perls/BotCore)
  file (MAKE_DIRECTORY ${PYTHON_OUTPUT_PATH}/perls/BotCore)
endif ()

# build local definitions
add_custom_command (
  OUTPUT ${PYTHON_OUTPUT_PATH}/perls/BotCore/__init__.py ${PYTHON_OUTPUT_PATH}/perls/BotCore/BotCore.py
  COMMAND cp -f ${CMAKE_CURRENT_BINARY_DIR}/BotCore.py ${INIT_PY} ${PYTHON_OUTPUT_PATH}/perls/BotCore/.
  DEPENDS ${CMAKE_CURRENT_BINARY_DIR}/BotCore.py
  WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}
  )

add_custom_target (BotCore ALL
  DEPENDS ${PYTHON_OUTPUT_PATH}/perls/BotCore/__init__.py ${PYTHON_OUTPUT_PATH}/perls/BotCore/BotCore.py
  )

install (DIRECTORY ${PYTHON_OUTPUT_PATH}/perls/BotCore
   DESTINATION ${PYTHON_INSTALL_PATH}/perls
   DIRECTORY_PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE
   PATTERN "*.pyc" EXCLUDE
  )

perls_python_add_custom_package (BotCore)
